/** @license
 * Shifty <http://jeremyckahn.github.com/shifty/>
 * Author: Jeremy Kahn - jeremyckahn@gmail.com
 * License: MIT
 * Version: 0.5.0+ (Tue, 27 Dec 2011 18:01:34 GMT)
 */
(function(){var a;(function(c){function g(a,b){var c;for(c in a)a.hasOwnProperty(c)&&b(a,c)}function h(a,b){return g(b,function(b,c){a[c]=b[c]}),a}function i(a,b){return g(b,function(b,c){typeof a[c]=="undefined"&&(a[c]=b[c])}),a}function j(a,b,c){var d,e;e=(a-b.timestamp)/b.duration;for(d in c.current)c.current.hasOwnProperty(d)&&b.to.hasOwnProperty(d)&&(c.current[d]=k(b.originalState[d],b.to[d],f[b.easing[d]],e));return c.current}function k(a,b,c,d){return a+(b-a)*c(d)}function l(a,b){return setTimeout(a,1e3/b)}function m(a,b,c,d){var e;for(e=0;e<b[a].length;e++)b[a][e].apply(c,d)}function n(b,c,d){g(a.prototype.filter,function(a,e){a[e][b]&&a[e][b].apply(c,d)})}function o(a,b){var c=a.timestamp+a.duration,e=Math.min(d(),c),f=e>=c;b.isTweening&&(f||(b.loopId=l(function(){o(a,b)},a.owner.fps)),n("beforeTween",a.owner,[b.current,a.originalState,a.to]),j(e,a,b),n("afterTween",a.owner,[b.current,a.originalState,a.to]),a.hook.step&&m("step",a.hook,a.owner,[b.current]),a.step&&a.step.call(b.current)),(f||!b.isTweening)&&a.owner.stop(!0)}function p(a,b){var c;return c={},typeof b=="string"?g(a,function(a,d){c[d]=b}):g(a,function(a,d){c[d]||(c[d]=b[d]||e)}),c}var d,e="linear",f;typeof SHIFTY_DEBUG_NOW=="function"?d=SHIFTY_DEBUG_NOW:d=function(){return+(new Date)},SHIFTY_DEBUG_NOW&&(c.timeoutHandler=o),a=function(a){return a=a||{},this._hook={},this._tweenParams={owner:this,hook:this._hook,data:{}},this._state={},this._state.current=a.initialState||{},this.fps=a.fps||30,this.easing=a.easing||e,this.duration=a.duration||500,this},a.prototype.tween=function(b,c,e,f,g){var j,k,l;if(this._state.isTweening)return;return j=this,k=this._tweenParams,l=this._state,this._state.loopId=0,this._state.pausedAtTime=null,c?(k.to=c||{},k.duration=e||this.duration,k.callback=f,k.easing=g||this.easing,l.current=b||{}):(k.step=b.step,k.callback=b.callback,k.to=b.to||b.target||{},k.duration=b.duration||this.duration,k.easing=b.easing||this.easing,l.current=b.from||{}),k.timestamp=d(),i(l.current,k.to),i(k.to,l.current),k.easing=p(l.current,k.easing),n("tweenCreated",k.owner,[l.current,k.originalState,k.to]),k.originalState=h({},l.current),l.isTweening=!0,this.resume(),b.start&&b.start(),this},a.prototype.to=function(b,c,d,e){return arguments.length===1?"to"in b?(b.from=this.get(),this.tween(b)):this.tween(this.get(),b):this.tween(this.get(),b,c,d,e),this},a.prototype.get=function(){return this._state.current},a.prototype.set=function(b){return this._state.current=b||{},this},a.prototype.stop=function(b){return clearTimeout(this._state.loopId),this._state.isTweening=!1,b&&(h(this._state.current,this._tweenParams.to),n("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.callback&&this._tweenParams.callback.call(this._state.current)),this},a.prototype.pause=function(){return clearTimeout(this._state.loopId),this._state.pausedAtTime=d(),this._state.isPaused=!0,this},a.prototype.resume=function(){var b;return b=this,this._state.isPaused&&(this._tweenParams.timestamp+=d()-this._state.pausedAtTime),o(b._tweenParams,b._state),this},a.prototype.hookAdd=function(b,c){this._hook.hasOwnProperty(b)||(this._hook[b]=[]),this._hook[b].push(c)},a.prototype.hookRemove=function(b,c){var d;if(!this._hook.hasOwnProperty(b))return;if(!c){this._hook[b]=[];return}for(d=this._hook[b].length;d>=0;d++)this._hook[b][d]===c&&this._hook[b].splice(d,1)},a.prototype.filter={},a.util={now:d,each:g,tweenProps:j,tweenProp:k,applyFilter:n,simpleCopy:h,weakCopy:i,composeEasingObject:p},f=a.prototype.formula={linear:function(a){return a}},typeof exports=="object"?module.exports=a:typeof define=="function"&&define.amd?define(function(){return a}):typeof c.Tweenable=="undefined"&&(c.Tweenable=a)})(this),function(){a.util.simpleCopy(a.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=.5)<1?.5*Math.pow(a,2):-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=.5)<1?.5*Math.pow(a,5):.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return a==0?0:a==1?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=.5)<1?-0.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){var b=1.70158;return a*a*((b+1)*a-b)},swingTo:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+.9375):2-(7.5625*(a-=2.625/2.75)*a+.984375)},easeFromTo:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,.25)}})}(),function(){function d(a){a.shift(),a.length?a[0]():a.running=!1}function e(a,b){return function(){a(),d(b)}}function f(a,b,c,d,e,f){return function(){c?a.tween(b,c,d,e,f):(b.callback=e,b.from?a.tween(b):a.to(b))}}var c=function(){};a.prototype.queue=function(a,b,d,g,h){var i;return this._tweenQueue||(this._tweenQueue=[]),g=g||a.callback||c,i=e(g,this._tweenQueue),this._tweenQueue.push(f(this,a,b,d,i,h)),this},a.prototype.queueStart=function(){return!this._tweenQueue.running&&this._tweenQueue.length>0&&(this._tweenQueue[0](),this._tweenQueue.running=!0),this},a.prototype.queueShift=function(){return this._tweenQueue.shift(),this},a.prototype.queuePop=function(){return this._tweenQueue.pop(),this},a.prototype.queueEmpty=function(){return this._tweenQueue.length=0,this},a.prototype.queueLength=function(){return this._tweenQueue.length}}(),function(){function g(a){return parseInt(a,16)}function h(a){return a=a.replace(/#/g,""),a.length===3&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),[g(a.substr(0,2)),g(a.substr(2,2)),g(a.substr(4,2))]}function i(a){var b,c;return b=h(a),c="rgb("+b[0]+","+b[1]+","+b[2]+")",c}function j(a){return typeof a=="string"&&(c.test(a)||d.test(a)||e.test(a))}function k(a){return typeof a=="string"&&(c.test(a)||d.test(a))}function l(b){a.util.each(b,function(a,b){k(a[b])&&(a[b]=i(a[b]))})}function m(b){var c;return c=[],a.util.each(b,function(a,b){j(a[b])&&c.push(b)}),c}function n(a){return a.match(/(\d+)/g)}function o(a,b){var c,d,e;d=b.length;for(c=0;c<d;c++)e=n(a[b[c]]),a["__r__"+b[c]]=+e[0],a["__g__"+b[c]]=+e[1],a["__b__"+b[c]]=+e[2],delete a[b[c]]}function p(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}function q(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a["__r__"+b[c]]=a[b[c]],a["__g__"+b[c]]=a[b[c]],a["__b__"+b[c]]=a[b[c]]}function r(a,b){var c,d;d=b.length;for(c=0;c<d;c++)delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var c=/^#([0-9]|[a-f]){3}$/i,d=/^#([0-9]|[a-f]){6}$/i,e=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,f;if(!a)return;a.prototype.filter.color={tweenCreated:function(b,c,d){l(b),l(c),l(d)},beforeTween:function(b,c,d){f=m(c),o(b,f),o(c,f),o(d,f),q(this._tweenParams.easing,f)},afterTween:function(b,c,d){p(b,f),p(c,f),p(d,f),r(this._tweenParams.easing,f)}}}(),function(){function f(a){return typeof a=="string"&&c.test(a)}function g(b){var d;return d={},a.util.each(b,function(a,b){f(a[b])&&(d[b]={suffix:a[b].match(c)[0]})}),d}function h(b,c){a.util.each(c,function(a,c){b[c]=+b[c].replace(d,"")})}function i(b,c){a.util.each(c,function(a,c){b[c]=b[c]+a[c].suffix})}var c=/(px|em|%|pc|pt|mm|cm|in|ex)/i,d=/([a-z]|%)/gi,e;a.prototype.filter.token={beforeTween:function(b,c,d){e=g(c),h(b,e),h(c,e),h(d,e)},afterTween:function(b,c,d){i(b,e),i(c,e),i(d,e)}}}(),function(){function c(b,c,d,e,f){var g;return g=a.util.composeEasingObject(b,f),a.util.tweenProps(e,{originalState:b,to:d,timestamp:0,duration:1,easing:g},{current:c})}if(!a)return;a.util.interpolate=function(b,d,e,f){var g,h,i;return b&&b.from&&(d=b.to,e=b.position,f=b.easing,b=b.from),i=new a,i._tweenParams.easing=f,g=a.util.simpleCopy({},b),a.util.applyFilter("tweenCreated",i,[g,b,d]),a.util.applyFilter("beforeTween",i,[g,b,d]),h=c(b,g,d,e,i._tweenParams.easing),a.util.applyFilter("afterTween",i,[h,b,d]),h},a.prototype.interpolate=function(b,c,d){var e;return e=a.util.interpolate(this.get(),b,c,d),this.set(e),e}}()})()
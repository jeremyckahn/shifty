/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com
  v0.1.0

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/tweeny/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(a){function b(){return+new Date}function d(a,b){for(var g in a)a.hasOwnProperty(g)&&b(a,g)}function c(a,b){d(b,function(g,b){a[b]=g[b]});return a}function i(a,b){d(b,function(b,c){typeof a[c]==="undefined"&&(a[c]=b[c])});return a}function f(a,b,g){for(var c in g.current)g.current.hasOwnProperty(c)&&b.to.hasOwnProperty(c)&&(g.current[c]=b.easingFunc(a-b.timestamp,b.originalState[c],b.to[c]-b.originalState[c],b.duration));return g.current}function e(a,b,c,d){var h;for(h=0;h<b[a].length;h++)b[a][h].apply(c,
d)}function j(b,c,g){d(a.Tweenable.prototype.filter,function(a,d){a[d][b]&&a[d][b].apply(c,g)})}function k(a,c){var g;g=b();g<a.timestamp+a.duration&&c.isAnimating?(j("beforeTween",a.owner,[c.current,a.originalState,a.to]),f(g,a,c),j("afterTween",a.owner,[c.current,a.originalState,a.to]),a.hook.step&&e("step",a.hook,a.owner,[c.current]),a.step.call(c.current),c.loopId=setTimeout(function(){k(a,c)},1E3/a.fps)):a.owner.stop(!0)}function m(){this.init=function(a){a=a||{};this._hook={};this._tweenParams=
{owner:this,hook:this._hook};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this};this.tween=function(a,d,g,o,h){var e=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,d?(this._tweenParams.step=function(){},this._state.current=a||{},this._tweenParams.to=d||{},this._tweenParams.duration=g||this.duration,this._tweenParams.callback=o||function(){},this._tweenParams.easing=
h||this.easing):(this._tweenParams.step=a.step||function(){},this._tweenParams.callback=a.callback||function(){},this._state.current=a.from||{},this._tweenParams.to=a.to||a.target||{},this._tweenParams.duration=a.duration||this.duration,this._tweenParams.easing=a.easing||this.easing),this._tweenParams.timestamp=b(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,i(this._state.current,this._tweenParams.to),i(this._tweenParams.to,this._state.current),j("tweenCreated",
this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=c({},this._state.current),this._state.isAnimating=!0,setTimeout(function(){k(e._tweenParams,e._state)},1E3/this.fps),this};this.to=function(a,b,c,d){typeof b==="undefined"?(a.from=this._state.current,this.tween(a)):this.tween(this._state.current,a,b,c,d);return this};this.get=function(){return this._state.current};this.set=function(a){this._state.current=a||{}};this.stop=
function(a){clearTimeout(this._state.loopId);this._state.isAnimating=!1;a&&(c(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};this.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=b();this._state.isPaused=!0;return this};this.resume=function(){var a=this;this._state.isPaused&&(this._tweenParams.timestamp+=this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){k(a._tweenParams,a._state)},1E3/
this.fps);return this};this.hookAdd=function(a,b){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(b)};this.hookRemove=function(a,b){var c;if(this._hook.hasOwnProperty(a))if(b)for(c=this._hook[a].length;c>=0;c++)this._hook[a][c]===b&&this._hook[a].splice(c,1);else this._hook[a]=[]};return this}m.prototype.filter={};m.util={now:b,each:d,tweenProps:f,applyFilter:j,simpleCopy:c};m.prototype.formula={linear:function(a,b,c,d){return c*a/d+b}};a.Tweenable=m})(this);
Tweenable.prototype.formula.easeInQuad=function(a,b,d,c){a/=c;return d*a*a+b};Tweenable.prototype.formula.easeOutQuad=function(a,b,d,c){a/=c;return-d*a*(a-2)+b};Tweenable.prototype.formula.easeInOutQuad=function(a,b,d,c){a/=c/2;if(a<1)return d/2*a*a+b;a--;return-d/2*(a*(a-2)-1)+b};Tweenable.prototype.formula.easeInCubic=function(a,b,d,c){a/=c;return d*a*a*a+b};Tweenable.prototype.formula.easeOutCubic=function(a,b,d,c){a/=c;a--;return d*(a*a*a+1)+b};
Tweenable.prototype.formula.easeInOutCubic=function(a,b,d,c){a/=c/2;if(a<1)return d/2*a*a*a+b;a-=2;return d/2*(a*a*a+2)+b};Tweenable.prototype.formula.easeInQuart=function(a,b,d,c){a/=c;return d*a*a*a*a+b};Tweenable.prototype.formula.easeOutQuart=function(a,b,d,c){a/=c;a--;return-d*(a*a*a*a-1)+b};Tweenable.prototype.formula.easeInOutQuart=function(a,b,d,c){a/=c/2;if(a<1)return d/2*a*a*a*a+b;a-=2;return-d/2*(a*a*a*a-2)+b};
Tweenable.prototype.formula.easeInQuint=function(a,b,d,c){a/=c;return d*a*a*a*a*a+b};Tweenable.prototype.formula.easeOutQuint=function(a,b,d,c){a/=c;a--;return d*(a*a*a*a*a+1)+b};Tweenable.prototype.formula.easeInOutQuint=function(a,b,d,c){a/=c/2;if(a<1)return d/2*a*a*a*a*a+b;a-=2;return d/2*(a*a*a*a*a+2)+b};Tweenable.prototype.formula.easeInSine=function(a,b,d,c){return-d*Math.cos(a/c*(Math.PI/2))+d+b};Tweenable.prototype.formula.easeOutSine=function(a,b,d,c){return d*Math.sin(a/c*(Math.PI/2))+b};
Tweenable.prototype.formula.easeInOutSine=function(a,b,d,c){return-d/2*(Math.cos(Math.PI*a/c)-1)+b};Tweenable.prototype.formula.easeInExpo=function(a,b,d,c){return d*Math.pow(2,10*(a/c-1))+b};Tweenable.prototype.formula.easeOutExpo=function(a,b,d,c){return d*(-Math.pow(2,-10*a/c)+1)+b};Tweenable.prototype.formula.easeInOutExpo=function(a,b,d,c){a/=c/2;if(a<1)return d/2*Math.pow(2,10*(a-1))+b;a--;return d/2*(-Math.pow(2,-10*a)+2)+b};
Tweenable.prototype.formula.easeInCirc=function(a,b,d,c){a/=c;return-d*(Math.sqrt(1-a*a)-1)+b};Tweenable.prototype.formula.easeOutCirc=function(a,b,d,c){a/=c;a--;return d*Math.sqrt(1-a*a)+b};Tweenable.prototype.formula.easeInOutCirc=function(a,b,d,c){a/=c/2;if(a<1)return-d/2*(Math.sqrt(1-a*a)-1)+b;a-=2;return d/2*(Math.sqrt(1-a*a)+1)+b};
(function(a){function b(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function d(a,b,d,e,j,k){return function(){d?a.tween(b,d,e,j,k):(b.callback=j,b.from?a.tween(b):a.to(b))}}if(a.Tweenable)a.Tweenable.prototype.queue=function(a,i,f,e,j){if(!this._tweenQueue)this._tweenQueue=[];e=e||a.callback||function(){};e=b(e,this._tweenQueue);this._tweenQueue.push(d(this,a,i,f,e,j));if(!this._tweenQueue.running)this._tweenQueue[0](),this._tweenQueue.running=!0;return this},a.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this},a.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this},a.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this},a.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(a){function b(a){return parseInt(a,16)}function d(a){a=a.replace(/#/g,"");a.length===3&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);a=[b(a.substr(0,2)),b(a.substr(2,2)),b(a.substr(4,2))];return"rgb("+a[0]+","+a[1]+","+a[2]+")"}function c(a){return typeof a==="string"&&(k.test(a)||m.test(a))}function i(b){a.Tweenable.util.each(b,function(a,b){c(a[b])&&(a[b]=d(a[b]))})}function f(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&(k.test(a[b])||m.test(a[b])||n.test(a[b]))&&
c.push(b)});return c}function e(a,b){var h,j,e;j=b.length;for(h=0;h<j;h++)e=(c(a[b[h]])?d(a[b[h]]):a[b[h]]).match(/(\d+)/g),a["__r__"+b[h]]=+e[0],a["__g__"+b[h]]=+e[1],a["__b__"+b[h]]=+e[2],delete a[b[h]]}function j(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var k=/^#([0-9]|[a-f]){3}$/i,m=/^#([0-9]|[a-f]){6}$/i,n=/^rgb\(\d+\s*,\d+\s*,\d+\s*\)\s*$/i,
l;if(a.Tweenable)a.Tweenable.prototype.filter.color={tweenCreated:function(a,b,c){i(a);i(b);i(c)},beforeTween:function(a,b,c){l=f(b);e(a,l);e(b,l);e(c,l)},afterTween:function(a,b,c){j(a,l);j(b,l);j(c,l)}}})(this);
(function(a){function b(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&i.test(a[b])&&c.push(b)});return c}function d(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=+a[b[c]].replace(i,"")}function c(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=Math.floor(a[b[c]])+"px"}var i=/px/i,f;if(a.Tweenable)a.Tweenable.prototype.filter.px={beforeTween:function(a,c,i){f=b(c);d(a,f);d(c,f);d(i,f)},afterTween:function(a,b,d){c(a,f);c(b,f);c(d,f)}}})(this);
(function(a){if(a.Tweenable)a.Tweenable.util.interpolate=function(b,d,c,i){var f;if(b&&b.from)d=b.to,c=b.position,i=b.easing,b=b.from;f=a.Tweenable.util.simpleCopy({},b);a.Tweenable.util.applyFilter("beforeTween",f,[f,b,d]);c=a.Tweenable.util.tweenProps(c,{originalState:b,to:d,timestamp:0,duration:1,easingFunc:a.Tweenable.prototype.formula[i]||a.Tweenable.prototype.formula.linear},{current:f});a.Tweenable.util.applyFilter("afterTween",c,[c,b,d]);return c},a.Tweenable.prototype.interpolate=function(b,
d,c){b=a.Tweenable.util.interpolate(this.get(),b,d,c);this.set(b);return b}})(this);

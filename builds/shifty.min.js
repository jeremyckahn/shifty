/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com
  v0.2.0

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/shifty/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(b){function a(){return+new Date}function e(a,d){for(var f in a)a.hasOwnProperty(f)&&d(a,f)}function h(a,d){e(d,function(d,g){a[g]=d[g]});return a}function k(a,d){e(d,function(d,g){typeof a[g]==="undefined"&&(a[g]=d[g])});return a}function j(a,d,f){var g,a=(a-d.timestamp)/d.duration;for(g in f.current)f.current.hasOwnProperty(g)&&d.to.hasOwnProperty(g)&&(f.current[g]=d.originalState[g]+(d.to[g]-d.originalState[g])*d.easingFunc(a));return f.current}function i(a,d,f,g){var b;for(b=0;b<d[a].length;b++)d[a][b].apply(f,
g)}function l(a,d,f){e(b.Tweenable.prototype.filter,function(g,b){g[b][a]&&g[b][a].apply(d,f)})}function n(c,d){var f;f=a();f<c.timestamp+c.duration&&d.isAnimating?(l("beforeTween",c.owner,[d.current,c.originalState,c.to]),j(f,c,d),l("afterTween",c.owner,[d.current,c.originalState,c.to]),c.hook.step&&i("step",c.hook,c.owner,[d.current]),c.step.call(d.current),d.loopId=setTimeout(function(){n(c,d)},1E3/c.fps)):c.owner.stop(!0)}function m(){this.init=function(a){a=a||{};this._hook={};this._tweenParams=
{owner:this,hook:this._hook};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this};this.tween=function(c,d,f,g,b){var e=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,d?(this._tweenParams.step=function(){},this._state.current=c||{},this._tweenParams.to=d||{},this._tweenParams.duration=f||this.duration,this._tweenParams.callback=g||function(){},this._tweenParams.easing=
b||this.easing):(this._tweenParams.step=c.step||function(){},this._tweenParams.callback=c.callback||function(){},this._state.current=c.from||{},this._tweenParams.to=c.to||c.target||{},this._tweenParams.duration=c.duration||this.duration,this._tweenParams.easing=c.easing||this.easing),this._tweenParams.timestamp=a(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,k(this._state.current,this._tweenParams.to),k(this._tweenParams.to,this._state.current),l("tweenCreated",
this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=h({},this._state.current),this._state.isAnimating=!0,setTimeout(function(){n(e._tweenParams,e._state)},1E3/this.fps),this};this.to=function(a,d,f,g){typeof d==="undefined"?(a.from=this.get(),this.tween(a)):this.tween(this.get(),a,d,f,g);return this};this.get=function(){return this._state.current};this.set=function(a){this._state.current=a||{};return this};this.stop=function(a){clearTimeout(this._state.loopId);
this._state.isAnimating=!1;a&&(h(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};this.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=a();this._state.isPaused=!0;return this};this.resume=function(){var a=this;this._state.isPaused&&(this._tweenParams.timestamp+=this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){n(a._tweenParams,a._state)},1E3/this.fps);return this};this.hookAdd=function(a,
d){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(d)};this.hookRemove=function(a,d){var f;if(this._hook.hasOwnProperty(a))if(d)for(f=this._hook[a].length;f>=0;f++)this._hook[a][f]===d&&this._hook[a].splice(f,1);else this._hook[a]=[]};return this}m.prototype.filter={};m.util={now:a,each:e,tweenProps:j,applyFilter:l,simpleCopy:h};m.prototype.formula={linear:function(a){return a}};b.Tweenable=m})(this);
(function(b){b.Tweenable.util.simpleCopy(b.Tweenable.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((b*=1.525)+1)*a-b);return 0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<
1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}})})(this);
(function(b){function a(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function e(a,b,e,i,l,n){return function(){e?a.tween(b,e,i,l,n):(b.callback=l,b.from?a.tween(b):a.to(b))}}b.Tweenable.prototype.queue=function(b,k,j,i,l){if(!this._tweenQueue)this._tweenQueue=[];i=i||b.callback||function(){};i=a(i,this._tweenQueue);this._tweenQueue.push(e(this,b,k,j,i,l));if(!this._tweenQueue.running)this._tweenQueue[0](),this._tweenQueue.running=!0;return this};b.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this};b.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this};b.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};b.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(b){function a(a){return parseInt(a,16)}function e(c){b.Tweenable.util.each(c,function(d,b){if(typeof d[b]==="string"&&(i.test(d[b])||l.test(d[b]))){var c;c=d[b];c=c.replace(/#/g,"");c.length===3&&(c=c.split(""),c=c[0]+c[0]+c[1]+c[1]+c[2]+c[2]);c=[a(c.substr(0,2)),a(c.substr(2,2)),a(c.substr(4,2))];d[b]="rgb("+c[0]+","+c[1]+","+c[2]+")"}})}function h(a){var d;d=[];b.Tweenable.util.each(a,function(a,c){typeof a[c]==="string"&&(i.test(a[c])||l.test(a[c])||n.test(a[c]))&&d.push(c)});return d}
function k(a,d){var b,g,e;g=d.length;for(b=0;b<g;b++)e=a[d[b]].match(/(\d+)/g),a["__r__"+d[b]]=+e[0],a["__g__"+d[b]]=+e[1],a["__b__"+d[b]]=+e[2],delete a[d[b]]}function j(a,b){var f,e;e=b.length;for(f=0;f<e;f++)a[b[f]]="rgb("+parseInt(a["__r__"+b[f]],10)+","+parseInt(a["__g__"+b[f]],10)+","+parseInt(a["__b__"+b[f]],10)+")",delete a["__r__"+b[f]],delete a["__g__"+b[f]],delete a["__b__"+b[f]]}var i=/^#([0-9]|[a-f]){3}$/i,l=/^#([0-9]|[a-f]){6}$/i,n=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,m;if(b.Tweenable)b.Tweenable.prototype.filter.color=
{tweenCreated:function(a,b,f){e(a);e(b);e(f)},beforeTween:function(a,b,f){m=h(b);k(a,m);k(b,m);k(f,m)},afterTween:function(a,b,f){j(a,m);j(b,m);j(f,m)}}})(this);
(function(b){function a(a){var e;e={};b.Tweenable.util.each(a,function(a,b){typeof a[b]==="string"&&k.test(a[b])&&(e[b]={suffix:a[b].match(k)[0]})});return e}function e(a,e){b.Tweenable.util.each(e,function(b,c){a[c]=+a[c].replace(j,"")})}function h(a,e){b.Tweenable.util.each(e,function(b,c){a[c]+=b[c].suffix})}var k=/(px|em|%|pc|pt|mm|cm|in|ex)/i,j=/([a-z]|%)/gi,i;b.Tweenable.prototype.filter.token={beforeTween:function(b,h,j){i=a(h);e(b,i);e(h,i);e(j,i)},afterTween:function(a,b,e){h(a,i);h(b,i);
h(e,i)}}})(this);
(function(b){if(b.Tweenable)b.Tweenable.util.interpolate=function(a,e,h,k){var j;if(a&&a.from)e=a.to,h=a.position,k=a.easing,a=a.from;j=b.Tweenable.util.simpleCopy({},a);b.Tweenable.util.applyFilter("tweenCreated",j,[j,a,e]);b.Tweenable.util.applyFilter("beforeTween",j,[j,a,e]);h=b.Tweenable.util.tweenProps(h,{originalState:a,to:e,timestamp:0,duration:1,easingFunc:b.Tweenable.prototype.formula[k]||b.Tweenable.prototype.formula.linear},{current:j});b.Tweenable.util.applyFilter("afterTween",h,[h,a,
e]);return h},b.Tweenable.prototype.interpolate=function(a,e,h){a=b.Tweenable.util.interpolate(this.get(),a,e,h);this.set(a);return a}})(this);

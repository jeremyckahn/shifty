/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com
  v0.1.3

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/tweeny/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(b){function a(){return+new Date}function f(a,c){for(var d in a)a.hasOwnProperty(d)&&c(a,d)}function j(a,c){f(c,function(c,e){a[e]=c[e]});return a}function k(a,c){f(c,function(c,e){typeof a[e]==="undefined"&&(a[e]=c[e])});return a}function g(a,c,d){var e,a=(a-c.timestamp)/c.duration;for(e in d.current)d.current.hasOwnProperty(e)&&c.to.hasOwnProperty(e)&&(d.current[e]=c.originalState[e]+(c.to[e]-c.originalState[e])*c.easingFunc(a));return d.current}function m(a,c,d,e){var b;for(b=0;b<c[a].length;b++)c[a][b].apply(d,
e)}function i(a,c,d){f(b.Tweenable.prototype.filter,function(e,b){e[b][a]&&e[b][a].apply(c,d)})}function n(h,c){var d;d=a();d<h.timestamp+h.duration&&c.isAnimating?(i("beforeTween",h.owner,[c.current,h.originalState,h.to]),g(d,h,c),i("afterTween",h.owner,[c.current,h.originalState,h.to]),h.hook.step&&m("step",h.hook,h.owner,[c.current]),h.step.call(c.current),c.loopId=setTimeout(function(){n(h,c)},1E3/h.fps)):h.owner.stop(!0)}function l(){this.init=function(a){a=a||{};this._hook={};this._tweenParams=
{owner:this,hook:this._hook};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this};this.tween=function(h,c,d,e,b){var f=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,c?(this._tweenParams.step=function(){},this._state.current=h||{},this._tweenParams.to=c||{},this._tweenParams.duration=d||this.duration,this._tweenParams.callback=e||function(){},this._tweenParams.easing=
b||this.easing):(this._tweenParams.step=h.step||function(){},this._tweenParams.callback=h.callback||function(){},this._state.current=h.from||{},this._tweenParams.to=h.to||h.target||{},this._tweenParams.duration=h.duration||this.duration,this._tweenParams.easing=h.easing||this.easing),this._tweenParams.timestamp=a(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,k(this._state.current,this._tweenParams.to),k(this._tweenParams.to,this._state.current),i("tweenCreated",
this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=j({},this._state.current),this._state.isAnimating=!0,setTimeout(function(){n(f._tweenParams,f._state)},1E3/this.fps),this};this.to=function(a,c,d,e){typeof c==="undefined"?(a.from=this._state.current,this.tween(a)):this.tween(this._state.current,a,c,d,e);return this};this.get=function(){return this._state.current};this.set=function(a){this._state.current=a||{}};this.stop=
function(a){clearTimeout(this._state.loopId);this._state.isAnimating=!1;a&&(j(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};this.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=a();this._state.isPaused=!0;return this};this.resume=function(){var a=this;this._state.isPaused&&(this._tweenParams.timestamp+=this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){n(a._tweenParams,a._state)},1E3/
this.fps);return this};this.hookAdd=function(a,c){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(c)};this.hookRemove=function(a,c){var d;if(this._hook.hasOwnProperty(a))if(c)for(d=this._hook[a].length;d>=0;d++)this._hook[a][d]===c&&this._hook[a].splice(d,1);else this._hook[a]=[]};return this}l.prototype.filter={};l.util={now:a,each:f,tweenProps:g,applyFilter:i,simpleCopy:j};l.prototype.formula={linear:function(a){return a}};b.Tweenable=l})(this);
(function(b){b.Tweenable.util.simpleCopy(b.Tweenable.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((b*=1.525)+1)*a-b);return 0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<
1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}})})(this);
(function(b){function a(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function f(a,b,g,f,i,n){return function(){g?a.tween(b,g,f,i,n):(b.callback=i,b.from?a.tween(b):a.to(b))}}if(b.Tweenable)b.Tweenable.prototype.queue=function(b,k,g,m,i){if(!this._tweenQueue)this._tweenQueue=[];m=m||b.callback||function(){};m=a(m,this._tweenQueue);this._tweenQueue.push(f(this,b,k,g,m,i));if(!this._tweenQueue.running)this._tweenQueue[0](),this._tweenQueue.running=!0;return this},b.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this},b.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this},b.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this},b.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(b){function a(a){return parseInt(a,16)}function f(h){b.Tweenable.util.each(h,function(c,b){if(typeof c[b]==="string"&&(m.test(c[b])||i.test(c[b]))){var e;e=c[b];e=e.replace(/#/g,"");e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);e=[a(e.substr(0,2)),a(e.substr(2,2)),a(e.substr(4,2))];c[b]="rgb("+e[0]+","+e[1]+","+e[2]+")"}})}function j(a){var c;c=[];b.Tweenable.util.each(a,function(a,b){typeof a[b]==="string"&&(m.test(a[b])||i.test(a[b])||n.test(a[b]))&&c.push(b)});return c}
function k(a,b){var d,e,i;e=b.length;for(d=0;d<e;d++)i=a[b[d]].match(/(\d+)/g),a["__r__"+b[d]]=+i[0],a["__g__"+b[d]]=+i[1],a["__b__"+b[d]]=+i[2],delete a[b[d]]}function g(a,b){var d,e;e=b.length;for(d=0;d<e;d++)a[b[d]]="rgb("+parseInt(a["__r__"+b[d]],10)+","+parseInt(a["__g__"+b[d]],10)+","+parseInt(a["__b__"+b[d]],10)+")",delete a["__r__"+b[d]],delete a["__g__"+b[d]],delete a["__b__"+b[d]]}var m=/^#([0-9]|[a-f]){3}$/i,i=/^#([0-9]|[a-f]){6}$/i,n=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,l;if(b.Tweenable)b.Tweenable.prototype.filter.color=
{tweenCreated:function(a,b,d){f(a);f(b);f(d)},beforeTween:function(a,b,d){l=j(b);k(a,l);k(b,l);k(d,l)},afterTween:function(a,b,d){g(a,l);g(b,l);g(d,l)}}})(this);
(function(b){function a(a){var i;i=[];b.Tweenable.util.each(a,function(a,b){typeof a[b]==="string"&&k.test(a[b])&&i.push(b)});return i}function f(a,b){var f,g;g=b.length;for(f=0;f<g;f++)a[b[f]]=+a[b[f]].replace(k,"")}function j(a,b){var f,g;g=b.length;for(f=0;f<g;f++)a[b[f]]=Math.floor(a[b[f]])+"px"}var k=/px/i,g;if(b.Tweenable)b.Tweenable.prototype.filter.px={beforeTween:function(b,i,j){g=a(i);f(b,g);f(i,g);f(j,g)},afterTween:function(a,b,f){j(a,g);j(b,g);j(f,g)}}})(this);
(function(b){if(b.Tweenable)b.Tweenable.util.interpolate=function(a,f,j,k){var g;if(a&&a.from)f=a.to,j=a.position,k=a.easing,a=a.from;g=b.Tweenable.util.simpleCopy({},a);b.Tweenable.util.applyFilter("tweenCreated",g,[g,a,f]);b.Tweenable.util.applyFilter("beforeTween",g,[g,a,f]);j=b.Tweenable.util.tweenProps(j,{originalState:a,to:f,timestamp:0,duration:1,easingFunc:b.Tweenable.prototype.formula[k]||b.Tweenable.prototype.formula.linear},{current:g});b.Tweenable.util.applyFilter("afterTween",j,[j,a,
f]);return j},b.Tweenable.prototype.interpolate=function(a,f,j){a=b.Tweenable.util.interpolate(this.get(),a,f,j);this.set(a);return a}})(this);

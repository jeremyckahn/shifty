/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com
  v0.1.2

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/tweeny/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(a){function c(){return+new Date}function b(a,c){for(var b in a)a.hasOwnProperty(b)&&c(a,b)}function d(a,c){b(c,function(c,b){a[b]=c[b]});return a}function g(a,c){b(c,function(c,b){typeof a[b]==="undefined"&&(a[b]=c[b])});return a}function e(a,c,b){for(var d in b.current)b.current.hasOwnProperty(d)&&c.to.hasOwnProperty(d)&&(b.current[d]=c.easingFunc(a-c.timestamp,c.originalState[d],c.to[d]-c.originalState[d],c.duration));return b.current}function h(a,c,b,d){var f;for(f=0;f<c[a].length;f++)c[a][f].apply(b,
d)}function f(c,d,k){b(a.Tweenable.prototype.filter,function(a,b){a[b][c]&&a[b][c].apply(d,k)})}function j(a,b){var d;d=c();d<a.timestamp+a.duration&&b.isAnimating?(f("beforeTween",a.owner,[b.current,a.originalState,a.to]),e(d,a,b),f("afterTween",a.owner,[b.current,a.originalState,a.to]),a.hook.step&&h("step",a.hook,a.owner,[b.current]),a.step.call(b.current),b.loopId=setTimeout(function(){j(a,b)},1E3/a.fps)):a.owner.stop(!0)}function i(){this.init=function(a){a=a||{};this._hook={};this._tweenParams=
{owner:this,hook:this._hook};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this};this.tween=function(a,b,k,l,e){var h=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,b?(this._tweenParams.step=function(){},this._state.current=a||{},this._tweenParams.to=b||{},this._tweenParams.duration=k||this.duration,this._tweenParams.callback=l||function(){},this._tweenParams.easing=
e||this.easing):(this._tweenParams.step=a.step||function(){},this._tweenParams.callback=a.callback||function(){},this._state.current=a.from||{},this._tweenParams.to=a.to||a.target||{},this._tweenParams.duration=a.duration||this.duration,this._tweenParams.easing=a.easing||this.easing),this._tweenParams.timestamp=c(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,g(this._state.current,this._tweenParams.to),g(this._tweenParams.to,this._state.current),f("tweenCreated",
this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=d({},this._state.current),this._state.isAnimating=!0,setTimeout(function(){j(h._tweenParams,h._state)},1E3/this.fps),this};this.to=function(a,b,c,d){typeof b==="undefined"?(a.from=this._state.current,this.tween(a)):this.tween(this._state.current,a,b,c,d);return this};this.get=function(){return this._state.current};this.set=function(a){this._state.current=a||{}};this.stop=
function(a){clearTimeout(this._state.loopId);this._state.isAnimating=!1;a&&(d(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};this.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=c();this._state.isPaused=!0;return this};this.resume=function(){var a=this;this._state.isPaused&&(this._tweenParams.timestamp+=this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){j(a._tweenParams,a._state)},1E3/
this.fps);return this};this.hookAdd=function(a,b){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(b)};this.hookRemove=function(a,b){var c;if(this._hook.hasOwnProperty(a))if(b)for(c=this._hook[a].length;c>=0;c++)this._hook[a][c]===b&&this._hook[a].splice(c,1);else this._hook[a]=[]};return this}i.prototype.filter={};i.util={now:c,each:b,tweenProps:e,applyFilter:f,simpleCopy:d};i.prototype.formula={linear:function(a,b,c,d){return c*a/d+b}};a.Tweenable=i})(this);
Tweenable.prototype.formula.easeInQuad=function(a,c,b,d){a/=d;return b*a*a+c};Tweenable.prototype.formula.easeOutQuad=function(a,c,b,d){a/=d;return-b*a*(a-2)+c};Tweenable.prototype.formula.easeInOutQuad=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a+c;a--;return-b/2*(a*(a-2)-1)+c};Tweenable.prototype.formula.easeInCubic=function(a,c,b,d){a/=d;return b*a*a*a+c};Tweenable.prototype.formula.easeOutCubic=function(a,c,b,d){a/=d;a--;return b*(a*a*a+1)+c};
Tweenable.prototype.formula.easeInOutCubic=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a*a+c;a-=2;return b/2*(a*a*a+2)+c};Tweenable.prototype.formula.easeInQuart=function(a,c,b,d){a/=d;return b*a*a*a*a+c};Tweenable.prototype.formula.easeOutQuart=function(a,c,b,d){a/=d;a--;return-b*(a*a*a*a-1)+c};Tweenable.prototype.formula.easeInOutQuart=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a*a*a+c;a-=2;return-b/2*(a*a*a*a-2)+c};
Tweenable.prototype.formula.easeInQuint=function(a,c,b,d){a/=d;return b*a*a*a*a*a+c};Tweenable.prototype.formula.easeOutQuint=function(a,c,b,d){a/=d;a--;return b*(a*a*a*a*a+1)+c};Tweenable.prototype.formula.easeInOutQuint=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a*a*a*a+c;a-=2;return b/2*(a*a*a*a*a+2)+c};Tweenable.prototype.formula.easeInSine=function(a,c,b,d){return-b*Math.cos(a/d*(Math.PI/2))+b+c};Tweenable.prototype.formula.easeOutSine=function(a,c,b,d){return b*Math.sin(a/d*(Math.PI/2))+c};
Tweenable.prototype.formula.easeInOutSine=function(a,c,b,d){return-b/2*(Math.cos(Math.PI*a/d)-1)+c};Tweenable.prototype.formula.easeInExpo=function(a,c,b,d){return b*Math.pow(2,10*(a/d-1))+c};Tweenable.prototype.formula.easeOutExpo=function(a,c,b,d){return b*(-Math.pow(2,-10*a/d)+1)+c};Tweenable.prototype.formula.easeInOutExpo=function(a,c,b,d){a/=d/2;if(a<1)return b/2*Math.pow(2,10*(a-1))+c;a--;return b/2*(-Math.pow(2,-10*a)+2)+c};
Tweenable.prototype.formula.easeInCirc=function(a,c,b,d){a/=d;return-b*(Math.sqrt(1-a*a)-1)+c};Tweenable.prototype.formula.easeOutCirc=function(a,c,b,d){a/=d;a--;return b*Math.sqrt(1-a*a)+c};Tweenable.prototype.formula.easeInOutCirc=function(a,c,b,d){a/=d/2;if(a<1)return-b/2*(Math.sqrt(1-a*a)-1)+c;a-=2;return b/2*(Math.sqrt(1-a*a)+1)+c};
(function(a){function c(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function b(a,b,c,h,f,j){return function(){c?a.tween(b,c,h,f,j):(b.callback=f,b.from?a.tween(b):a.to(b))}}if(a.Tweenable)a.Tweenable.prototype.queue=function(a,g,e,h,f){if(!this._tweenQueue)this._tweenQueue=[];h=h||a.callback||function(){};h=c(h,this._tweenQueue);this._tweenQueue.push(b(this,a,g,e,h,f));if(!this._tweenQueue.running)this._tweenQueue[0](),this._tweenQueue.running=!0;return this},a.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this},a.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this},a.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this},a.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(a){function c(a){return parseInt(a,16)}function b(b){a.Tweenable.util.each(b,function(a,b){if(typeof a[b]==="string"&&(h.test(a[b])||f.test(a[b]))){var d;d=a[b];d=d.replace(/#/g,"");d.length===3&&(d=d.split(""),d=d[0]+d[0]+d[1]+d[1]+d[2]+d[2]);d=[c(d.substr(0,2)),c(d.substr(2,2)),c(d.substr(4,2))];a[b]="rgb("+d[0]+","+d[1]+","+d[2]+")"}})}function d(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&(h.test(a[b])||f.test(a[b])||j.test(a[b]))&&c.push(b)});return c}
function g(a,b){var c,d,f;d=b.length;for(c=0;c<d;c++)f=a[b[c]].match(/(\d+)/g),a["__r__"+b[c]]=+f[0],a["__g__"+b[c]]=+f[1],a["__b__"+b[c]]=+f[2],delete a[b[c]]}function e(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var h=/^#([0-9]|[a-f]){3}$/i,f=/^#([0-9]|[a-f]){6}$/i,j=/^rgb\(\d+\s*,\d+\s*,\d+\s*\)\s*$/i,i;if(a.Tweenable)a.Tweenable.prototype.filter.color=
{tweenCreated:function(a,c,d){b(a);b(c);b(d)},beforeTween:function(a,b,c){i=d(b);g(a,i);g(b,i);g(c,i)},afterTween:function(a,b,c){e(a,i);e(b,i);e(c,i)}}})(this);
(function(a){function c(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&g.test(a[b])&&c.push(b)});return c}function b(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=+a[b[c]].replace(g,"")}function d(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=Math.floor(a[b[c]])+"px"}var g=/px/i,e;if(a.Tweenable)a.Tweenable.prototype.filter.px={beforeTween:function(a,d,g){e=c(d);b(a,e);b(d,e);b(g,e)},afterTween:function(a,b,c){d(a,e);d(b,e);d(c,e)}}})(this);
(function(a){if(a.Tweenable)a.Tweenable.util.interpolate=function(c,b,d,g){var e;if(c&&c.from)b=c.to,d=c.position,g=c.easing,c=c.from;e=a.Tweenable.util.simpleCopy({},c);a.Tweenable.util.applyFilter("tweenCreated",e,[e,c,b]);a.Tweenable.util.applyFilter("beforeTween",e,[e,c,b]);d=a.Tweenable.util.tweenProps(d,{originalState:c,to:b,timestamp:0,duration:1,easingFunc:a.Tweenable.prototype.formula[g]||a.Tweenable.prototype.formula.linear},{current:e});a.Tweenable.util.applyFilter("afterTween",d,[d,c,
b]);return d},a.Tweenable.prototype.interpolate=function(c,b,d){c=a.Tweenable.util.interpolate(this.get(),c,b,d);this.set(c);return c}})(this);
